pipeline {
    agent any
    
    stages {
        stage('System Health Check') {
            steps {
                sh '''
                    echo "=== Memory Usage ==="
                    free -h
                    echo "=== CPU Usage ==="
                    top -bn1 | head -20
                '''
            }
        }
        
        stage('Install Dependencies') {
            steps {
                sh 'npm install'  // or your package manager
            }
        }
        
        stage('Run Tests') {
            steps {
                sh 'npm test'  // or your test command
            }
        }
        
        stage('Performance Monitoring') {
            steps {
                sh '''
                    echo "=== RAM Check Before ==="
                    free -h
                    npm start &  // Start your server
                    sleep 5
                    echo "=== RAM Check After ==="
                    free -h
                '''
            }
        }
    }
}